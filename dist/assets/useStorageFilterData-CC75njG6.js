import{g as f,h}from"./auth-Buz3Qiex.js";import{G as c,g,q as v}from"./index-D3wbM7oO.js";const m="https://api.mgoods.uz/api";async function S(){try{const a=await f(),t=await fetch(`${m}/storages/get?page=1&per_page=1`,{headers:a});return(await h(t)).filters||{users:[],stores:[],kontragents:[]}}catch(a){throw console.error("Error fetching storage filters:",a),a}}async function w(a=1,t={}){var o,n;try{const s=await f(),l=new URLSearchParams;l.append("page",a),t.per_page&&(l.append("per_page",t.per_page),delete t.per_page);const p={...t};!c.isSuperAdmin&&((o=c.user)!=null&&o.id)&&(p.user_id=c.user.id.toString()),Object.entries(p).forEach(([u,e])=>{e!==void 0&&e!==""&&l.append(u,e)});const d=await fetch(`${m}/storages/get?${l.toString()}`,{headers:s}),i=await h(d);return!c.isSuperAdmin&&((n=c.user)!=null&&n.id)&&(i.data=i.data.filter(u=>{var e;return((e=u.user_id)==null?void 0:e.toString())===c.user.id.toString()})),i}catch(s){throw console.error("Error fetching storage items:",s),s}}function y(){const a=g([{value:"",label:"All Users"}]),t=g([{value:"",label:"All Stores"}]),o=g([{value:"",label:"All Kontragents"}]),n=g(!0),s=g(null),l=[{value:"income",label:"Kirim"},{value:"outcome",label:"Chiqim"},{value:"enter",label:"Enter"},{value:"loss",label:"Loss"}];return v(async()=>{var d,i,u;try{n.value=!0;const e=await S();(d=e.users)!=null&&d.length&&(a.value=[{value:"",label:"All Users"},...e.users.map(r=>({value:r.id.toString(),label:r.name}))]),(i=e.stores)!=null&&i.length&&(t.value=[{value:"",label:"All Stores"},...e.stores.map(r=>({value:r.id.toString(),label:r.name}))]),(u=e.kontragents)!=null&&u.length&&(o.value=[{value:"",label:"All Kontragents"},...e.kontragents.map(r=>({value:r.id.toString(),label:r.name}))])}catch(e){s.value=e.message,console.error("Error loading filter data:",e)}finally{n.value=!1}}),{users:a,stores:t,kontragents:o,types:l,loading:n,error:s}}export{w as f,y as u};
