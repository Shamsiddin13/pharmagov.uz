import{f as W}from"./formatters-Do8IhxAy.js";import{o as a,c as i,r as Z,n as Y,a as e,F as $,b as E,t as b,d as k,w as A,e as I,f as K,u as T,R as oe,g as p,h as G,i as _,v as C,j as N,k as q,l as J,m as ee,p as X,q as L,s as de,x as ie,y as ne,z as ue,T as ge}from"./index-D3wbM7oO.js";import{_ as M}from"./CopyableText-dJNKi8uI.js";import{_ as F}from"./Button-1RoVZDeX.js";import{_ as ce}from"./Pagination-CtU1Q35g.js";import{f as H,a as ye}from"./products-Dz_E5vv_.js";import{_ as Q,a as me}from"./NumberInput-CUzi_oTe.js";import{g as te,h as re}from"./auth-Buz3Qiex.js";const ve={class:"inline-flex items-center"},pe={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"},xe={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},be={__name:"SortButton",props:{active:{type:Boolean,default:!1},direction:{type:String,default:"asc"}},setup(v){return(x,n)=>(a(),i("span",ve,[Z(x.$slots,"default"),(a(),i("svg",{class:Y(["w-4 h-4 ml-1",{"text-gray-400":!v.active,"text-indigo-500":v.active}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[v.direction==="asc"?(a(),i("path",pe)):(a(),i("path",xe))],2))]))}},fe={class:"overflow-x-auto"},ke={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},he={class:"bg-gray-50 dark:bg-gray-800"},we={class:"flex items-center space-x-1"},_e=["onClick"],$e={key:1},Se={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Ue={class:"px-6 py-4 whitespace-nowrap align-middle"},Pe=["src","alt"],qe={class:"px-6 py-4 align-middle"},Ce={class:"text-sm font-medium text-gray-900 dark:text-white"},Ae={class:"px-6 py-4 align-middle"},Ke={class:"px-6 py-4 align-middle"},ze={class:"px-6 py-4 align-middle"},Ve={class:"flex flex-col space-y-1"},Fe={class:"px-6 py-4 align-middle"},Ee={class:"text-sm text-gray-500 dark:text-gray-400"},De={class:"px-6 py-4 align-middle"},Me={class:"text-sm text-gray-500 dark:text-gray-400"},Ne={class:"px-6 py-4 align-middle"},Ie={class:"text-sm text-gray-500 dark:text-gray-400"},je={class:"px-6 py-4 align-middle"},Be={class:"text-sm text-gray-500 dark:text-gray-400"},Re={__name:"ProductsTable",props:{products:{type:Array,required:!0},sortColumn:{type:String,required:!0},sortOrder:{type:String,required:!0},categories:{type:Array,required:!0},stores:{type:Array,required:!0}},emits:["sort"],setup(v,{emit:x}){const n=v,f=x,u=[{key:"name",label:"Mahsulot nomi",sortable:!0},{key:"article",label:"Article",sortable:!0},{key:"sku",label:"SKU",sortable:!0},{key:"uzum_sku",label:"Uzum SKU",sortable:!0},{key:"buy_price",label:"Xarid narxi",sortable:!0},{key:"sell_price",label:"Sotuv narxi",sortable:!0},{key:"category",label:"Kategoriya",sortable:!0},{key:"store",label:"Do'kon",sortable:!0}],m=r=>{const o=n.categories.find(g=>g.id===r);return(o==null?void 0:o.name)||"-"},s=r=>{const o=n.stores.find(g=>g.id===r);return(o==null?void 0:o.name)||"-"},y=r=>{r.sortable&&f("sort",r.key)},h=r=>r.sortable?n.sortColumn!==r.key?"none":n.sortOrder:null;return(r,o)=>(a(),i("div",fe,[e("table",ke,[e("thead",he,[e("tr",null,[o[1]||(o[1]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Rasm ",-1)),(a(),i($,null,E(u,g=>e("th",{key:g.key,scope:"col",class:"px-6 py-3 text-left"},[e("div",we,[g.sortable?(a(),i("button",{key:0,onClick:U=>y(g),class:"group inline-flex items-center space-x-1 font-medium text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"},[e("span",null,b(g.label),1),k(be,{state:h(g)},null,8,["state"])],8,_e)):(a(),i("span",$e,b(g.label),1))])])),64))])]),e("tbody",Se,[(a(!0),i($,null,E(v.products,g=>(a(),i("tr",{key:g.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[k(T(oe),{to:`/products/${g.id}`,class:"contents hover:bg-gray-50 dark:hover:bg-gray-700"},{default:A(()=>[e("td",Ue,[e("img",{src:g.image,alt:g.name,class:"h-12 w-12 object-cover rounded",onError:o[0]||(o[0]=U=>U.target.src="https://via.placeholder.com/48")},null,40,Pe)]),e("td",qe,[e("div",Ce,[k(M,{text:g.name},null,8,["text"])])]),e("td",Ae,[k(M,{text:g.article},null,8,["text"])]),e("td",Ke,[k(M,{text:g.sku},null,8,["text"])]),e("td",ze,[e("div",Ve,[g.uzum_sku?(a(),I(M,{key:0,text:g.uzum_sku},null,8,["text"])):K("",!0),g.uzum_sku_title?(a(),I(M,{key:1,text:g.uzum_sku_title,class:"text-xs text-gray-500 dark:text-gray-400"},null,8,["text"])):K("",!0)])]),e("td",Fe,[e("div",Ee,b(T(W)(g.buy_price,g.currency)),1)]),e("td",De,[e("div",Me,b(T(W)(g.sell_price,g.currency)),1)]),e("td",Ne,[e("div",Ie,b(m(g.category_id)),1)]),e("td",je,[e("div",Be,b(s(g.store_id)),1)])]),_:2},1032,["to"])]))),128))])])]))}},Le={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6 mb-6"},Oe={class:"space-y-6"},Te={class:"grid grid-cols-1 gap-4"},Xe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ze=["value"],We=["value"],He={class:"flex justify-end space-x-4"},Qe={__name:"ProductFilters",props:{categories:{type:Array,default:()=>[]},stores:{type:Array,default:()=>[]},initialFilters:{type:Object,default:()=>({search:"",name:"",sku:"",uzum_sku:"",ean13:"",category_id:"all",store_id:"all"})}},emits:["filter"],setup(v,{emit:x}){const n=v,f=x,u=p({...n.initialFilters});G(()=>n.initialFilters,h=>{u.value={...h}});const m=()=>{f("filter",{...u.value})},s=()=>{u.value={search:"",name:"",sku:"",uzum_sku:"",ean13:"",category_id:"all",store_id:"all"},f("filter",{...u.value})},y=h=>{h.key==="Enter"&&m()};return(h,r)=>(a(),i("div",Le,[e("div",Oe,[e("div",Te,[e("div",null,[r[7]||(r[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Ummumiy qidirish",-1)),_(e("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=o=>u.value.search=o),placeholder:"Mahsulotlarni qidirish...",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},null,544),[[C,u.value.search]])])]),e("div",Xe,[e("div",null,[r[8]||(r[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Mahsulot nomi",-1)),_(e("input",{type:"text","onUpdate:modelValue":r[1]||(r[1]=o=>u.value.name=o),placeholder:"Mahsulot nomi...",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},null,544),[[C,u.value.name]])]),e("div",null,[r[9]||(r[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Artikul",-1)),_(e("input",{type:"text","onUpdate:modelValue":r[2]||(r[2]=o=>u.value.sku=o),placeholder:"Artikul boyicha qidirish...",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},null,544),[[C,u.value.sku]])]),e("div",null,[r[10]||(r[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Uzum SKU",-1)),_(e("input",{type:"text","onUpdate:modelValue":r[3]||(r[3]=o=>u.value.uzum_sku=o),placeholder:"Uzum SKU boyicha qidirish...",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},null,544),[[C,u.value.uzum_sku]])]),e("div",null,[r[11]||(r[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"EAN13",-1)),_(e("input",{type:"text","onUpdate:modelValue":r[4]||(r[4]=o=>u.value.ean13=o),placeholder:"EAN13 boyicha qidirish...",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},null,544),[[C,u.value.ean13]])]),e("div",null,[r[13]||(r[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Kategoriya",-1)),_(e("select",{"onUpdate:modelValue":r[5]||(r[5]=o=>u.value.category_id=o),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},[r[12]||(r[12]=e("option",{value:"all"},"Barcha kategoriyalar",-1)),(a(!0),i($,null,E(v.categories,o=>(a(),i("option",{key:o.id,value:o.id},b(o.name),9,Ze))),128))],544),[[N,u.value.category_id]])]),e("div",null,[r[15]||(r[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Do'kon",-1)),_(e("select",{"onUpdate:modelValue":r[6]||(r[6]=o=>u.value.store_id=o),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",onKeydown:y},[r[14]||(r[14]=e("option",{value:"all"},"Barcha do'konlar",-1)),(a(!0),i($,null,E(v.stores,o=>(a(),i("option",{key:o.id,value:o.id},b(o.name),9,We))),128))],544),[[N,u.value.store_id]])])]),e("div",He,[k(F,{onClick:s,variant:"secondary"},{default:A(()=>r[16]||(r[16]=[q("Filterni tozalash")])),_:1}),k(F,{onClick:m,variant:"primary"},{default:A(()=>r[17]||(r[17]=[q("Filterni qo'shish")])),_:1})])])]))}},Ye={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},Ge={key:0,class:"text-center py-8"},Je={key:1,class:"bg-red-50 dark:bg-red-900/50 text-red-600 dark:text-red-400 p-4"},et={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400"},tt={__name:"ProductList",setup(v,{expose:x}){const n=J(),f=ee(),u=p([]),m=p({}),s=p([]),y=p([]),h=p(!0),r=p(null),o=p(1),g=p(20),U=p({categories:[],stores:[]}),d=()=>{const c=n.query;return{filters:{search:c.search||"",name:c.name||"",sku:c.sku||"",uzum_sku_title:c.uzum_sku_title||"",ean13:c.ean13||"",category_id:c.category_id||"all",store_id:c.store_id||"all"},sort:{column:c.sort_by||"id",order:c.sort_order||"desc"}}},w=p(d()),O=X(()=>w.value.filters),j=X(()=>w.value.sort.column),P=X(()=>w.value.sort.order),t=()=>{const c={};Object.entries(w.value.filters).forEach(([S,V])=>{V&&V!==""&&V!=="all"&&(c[S]=V)}),(w.value.sort.column!=="id"||w.value.sort.order!=="desc")&&(c.sort_by=w.value.sort.column,c.sort_order=w.value.sort.order),f.replace({query:c})},l=c=>{w.value.filters=c,t(),o.value=1,z()},B=c=>{const S=w.value.sort;S.column===c?S.order=S.order==="asc"?"desc":"asc":(S.column=c,S.order="asc"),t(),z()},D=async()=>{if(U.value.categories.length===0||U.value.stores.length===0)try{const c=await H(1,{per_page:1});U.value.categories=c.categories,U.value.stores=c.stores,s.value=c.categories,y.value=c.stores}catch(c){console.error("Error loading reference data:",c)}else s.value=U.value.categories,y.value=U.value.stores},z=async(c={})=>{const{preserveScroll:S=!1,showLoader:V=!0}=c;V&&!S&&(h.value=!0);try{await D();const R=await H(o.value,{per_page:g.value,...w.value.filters,sort_by:w.value.sort.column,sort_order:w.value.sort.order});u.value=R.data,m.value=R.meta,r.value=null}catch(R){console.error("Error loading products:",R),r.value="Failed to load products"}finally{h.value=!1}},se=c=>{o.value=c,z({preserveScroll:!0})},le=c=>{g.value=c,o.value=1,z()};return G(()=>n.query,()=>{w.value=d(),z()}),x({loadProducts:z,categories:s,stores:y}),L(async()=>{await z()}),(c,S)=>(a(),i("div",null,[k(Qe,{categories:s.value,stores:y.value,"initial-filters":O.value,onFilter:l},null,8,["categories","stores","initial-filters"]),e("div",Ye,[h.value?(a(),i("div",Ge,S[0]||(S[0]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"},null,-1)]))):r.value?(a(),i("div",Je,b(r.value),1)):u.value.length===0?(a(),i("div",et," Mahsulotlar topilmadi. ")):(a(),i($,{key:3},[!h.value&&!r.value?(a(),I(Re,{key:0,products:u.value,categories:s.value,stores:y.value,"sort-column":j.value,"sort-order":P.value,onSort:B},null,8,["products","categories","stores","sort-column","sort-order"])):K("",!0),k(ce,{meta:m.value,onPageChange:se,onPerPageChange:le},null,8,["meta"])],64))])]))}},rt={class:"sticky top-0 flex-shrink-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 md:px-6 py-4 flex items-center justify-between"},at={class:"text-xl font-semibold text-gray-800 dark:text-white truncate"},st={class:"flex-1 overflow-y-auto"},lt={class:"p-4 md:p-6"},ot={__name:"SidebarForm",props:{isOpen:{type:Boolean,required:!0},width:{type:String,default:"600px"}},emits:["close"],setup(v){const x=p(window.innerWidth<768),n=()=>{x.value=window.innerWidth<768};return L(()=>{window.addEventListener("resize",n)}),de(()=>{window.removeEventListener("resize",n)}),(f,u)=>(a(),i($,null,[e("div",{class:Y(["fixed inset-0 left-auto bg-white dark:bg-gray-800 shadow-lg transition-all duration-300 z-50 flex flex-col md:w-[600px]",v.isOpen?"translate-x-0":"translate-x-full"]),style:ie({width:x.value?"100%":v.width})},[e("div",rt,[e("h2",at,[Z(f.$slots,"title",{},()=>[u[2]||(u[2]=q("Form Title"))])]),e("button",{onClick:u[0]||(u[0]=m=>f.$emit("close")),class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 p-2 -mr-2"},u[3]||(u[3]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),e("div",st,[e("div",lt,[Z(f.$slots,"default")])])],6),v.isOpen?(a(),i("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:u[1]||(u[1]=m=>f.$emit("close"))})):K("",!0)],64))}},dt={class:"space-y-6"},it={key:0,class:"flex items-center justify-center py-8"},nt={key:1,class:"bg-red-50 dark:bg-red-900/50 text-red-600 dark:text-red-400 p-3 rounded-md"},ut={key:2,class:"space-y-6"},gt={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},ct={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},yt={class:"mt-1 text-gray-900 dark:text-white"},mt={class:"mt-1 text-gray-900 dark:text-white"},vt={class:"mt-1 text-gray-900 dark:text-white"},pt={class:"mt-1 text-gray-900 dark:text-white"},xt={class:"mt-1 text-gray-900 dark:text-white"},bt={class:"mt-1 text-2xl font-semibold text-gray-900 dark:text-white"},ft={class:"mt-1 text-2xl font-semibold text-gray-900 dark:text-white"},kt={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},ht={class:"space-y-4"},wt={class:"mt-1 text-gray-900 dark:text-white"},_t={key:0},$t=["src","alt"],St={__name:"ProductDetailsCard",setup(v){const x=J(),n=p(null),f=p(!0),u=p(null);return L(async()=>{try{n.value=await ye(x.params.id)}catch(m){console.error("Error loading product:",m),u.value="Failed to load product details"}finally{f.value=!1}}),(m,s)=>{var y,h;return a(),i("div",dt,[f.value?(a(),i("div",it,s[0]||(s[0]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-500"},null,-1)]))):u.value?(a(),i("div",nt,b(u.value),1)):n.value?(a(),i("div",ut,[e("div",gt,[s[8]||(s[8]=e("h2",{class:"text-2xl font-semibold text-gray-900 dark:text-white mb-4"},"Asosiy ma'lumotlar ",-1)),e("div",ct,[e("div",null,[s[1]||(s[1]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"Mahsulot nomi",-1)),e("p",yt,b(n.value.name),1)]),e("div",null,[s[2]||(s[2]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"Kategoriya",-1)),e("p",mt,b(((y=n.value.category)==null?void 0:y.name)||"N/A"),1)]),e("div",null,[s[3]||(s[3]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"Do'kon",-1)),e("p",vt,b(((h=n.value.store)==null?void 0:h.name)||"N/A"),1)]),e("div",null,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"IKPU",-1)),e("p",pt,b(n.value.IKPU||"N/A"),1)]),e("div",null,[s[5]||(s[5]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"SKU",-1)),e("p",xt,b(n.value.uzum_sku_title||"N/A"),1)]),e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"Xarid narxi",-1)),e("p",bt,b(Number(n.value.buy_price).toLocaleString())+" "+b(n.value.currency),1)]),e("div",null,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium text-gray-500 dark:text-gray-400"},"Sotuv narxi",-1)),e("p",ft,b(Number(n.value.sell_price).toLocaleString())+" "+b(n.value.currency),1)])])]),e("div",kt,[s[11]||(s[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Qo'shimcha ma'lumotlar",-1)),e("div",ht,[e("div",null,[s[9]||(s[9]=e("label",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"O'lchov boshlig'i",-1)),e("p",wt,b(n.value.weight||"N/A"),1)]),n.value.image?(a(),i("div",_t,[s[10]||(s[10]=e("label",{class:"text-sm font-medium text-gray-500 dark:text-gray-400"},"Rasm",-1)),e("img",{src:n.value.image,alt:n.value.name,class:"mt-2 max-w-xs rounded-lg"},null,8,$t)])):K("",!0)])])])):K("",!0)])}}},ae="https://api.mgoods.uz/api";async function Ut(){try{const v=await te(),x=await fetch(`${ae}/categories/get`,{headers:v});return(await re(x)).data||[]}catch(v){throw console.error("Error fetching categories:",v),v}}async function Pt(){try{const v=await te(),x=await fetch(`${ae}/stores/get`,{headers:v});return(await re(x)).data||[]}catch(v){throw console.error("Error fetching stores:",v),v}}const qt={class:"h-full flex flex-col"},Ct={key:0,class:"flex items-center justify-center h-full flex-col"},At={key:1,class:"flex items-center justify-center h-full"},Kt={class:"flex justify-end pt-4 mt-6 border-t border-gray-200 dark:border-gray-700"},zt={class:"flex-1 space-y-6"},Vt={key:0,class:"bg-red-50 dark:bg-red-900/50 text-red-600 dark:text-red-400 p-3 rounded-md text-sm"},Ft={class:"space-y-4"},Et=["value"],Dt=["value"],Mt={class:"space-y-4"},Nt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},It={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},jt={class:"space-y-4"},Bt={class:"flex justify-end gap-3 pt-4 mt-6 border-t border-gray-200 dark:border-gray-700"},Rt={__name:"AddProductForm",props:{},emits:["close","product-added"],setup(v,{emit:x}){const n=ee(),f=x,u=ne(),m=p(!1),s=p(""),y=p(!1),h=p([]),r=p([]),o=p(!0),g=p(!1),U=p(null);L(async()=>{try{const[P,t]=await Promise.all([Ut(),Pt()]);h.value=P,r.value=t}catch(P){console.error("Error loading reference data:",P),s.value="Failed to load form data. Please try again."}finally{o.value=!1}});const d=p({name:"",category_id:"",store_id:"",buy_price:"",sell_price:"",IKPU:"",currency:"UZS",image:null,weight:"",ean13:""}),w=()=>d.value.name?d.value.category_id?d.value.store_id?d.value.buy_price?d.value.sell_price?d.value.IKPU?d.value.currency?null:"Currency is required":"IKPU is required":"Sell price is required":"Buy price is required":"Store is required":"Category is required":"Product name is required",O=P=>{d.value.image=P},j=async(P=!1)=>{if(y.value)return;s.value="";const t=w();if(t){s.value=t;return}y.value=!0,m.value=!0;try{const l=new FormData;l.append("name",d.value.name),l.append("category_id",d.value.category_id),l.append("store_id",d.value.store_id),l.append("buy_price",d.value.buy_price),l.append("sell_price",d.value.sell_price),l.append("IKPU",d.value.IKPU),l.append("currency",d.value.currency),d.value.image&&l.append("image",d.value.image),d.value.weight&&l.append("weight",d.value.weight),d.value.ean13&&l.append("ean13",d.value.ean13);const B=await fetch("https://api.mgoods.uz/api/products/product/create",{method:"POST",body:l,headers:{Authorization:`Bearer ${u.token.value}`}}),D=await B.json();if(!B.ok)throw new Error(D.message||"Failed to add product");f("product-added",D.data),P?n.push({name:"product-details",params:{id:D.data.id}}):f("close")}catch(l){s.value=l.message||"Failed to add product",console.error("Error adding product:",l)}finally{y.value=!1,m.value=!1}};return(P,t)=>(a(),i("div",qt,[m.value?(a(),i("div",Ct,t[13]||(t[13]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1),e("p",{class:"mt-4 text-gray-700 dark:text-gray-300"},"Mahsulot yaratilmoqda...",-1)]))):o.value?(a(),i("div",At,t[14]||(t[14]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500"},null,-1)]))):g.value?(a(),i($,{key:2},[k(St,{"product-id":U.value},null,8,["product-id"]),e("div",Kt,[k(F,{onClick:t[0]||(t[0]=l=>P.$emit("close")),variant:"secondary",class:"mr-3"},{default:A(()=>t[15]||(t[15]=[q("Yopish")])),_:1})])],64)):(a(),i("form",{key:3,class:"h-full flex flex-col",onSubmit:t[12]||(t[12]=ue(()=>{},["prevent"]))},[e("div",zt,[s.value?(a(),i("div",Vt,b(s.value),1)):K("",!0),e("div",Ft,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Mahsulot nomi",-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>d.value.name=l),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"Mahsulot nomi"},null,512),[[C,d.value.name]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Kategoriya",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>d.value.category_id=l),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500"},[t[17]||(t[17]=e("option",{value:""},"Kategoriya tanlang",-1)),(a(!0),i($,null,E(h.value,l=>(a(),i("option",{key:l.id,value:l.id},b(l.name),9,Et))),128))],512),[[N,d.value.category_id]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Do'kon",-1)),_(e("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>d.value.store_id=l),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500"},[t[19]||(t[19]=e("option",{value:""},"Do'kon tanlang",-1)),(a(!0),i($,null,E(r.value,l=>(a(),i("option",{key:l.id,value:l.id},b(l.name),9,Dt))),128))],512),[[N,d.value.store_id]])])]),e("div",Mt,[e("div",Nt,[e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Xarid narxi",-1)),k(Q,{modelValue:d.value.buy_price,"onUpdate:modelValue":t[4]||(t[4]=l=>d.value.buy_price=l),placeholder:""},null,8,["modelValue"])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Sotuv narxi",-1)),k(Q,{modelValue:d.value.sell_price,"onUpdate:modelValue":t[5]||(t[5]=l=>d.value.sell_price=l),placeholder:""},null,8,["modelValue"])])]),e("div",It,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"IKPU",-1)),_(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>d.value.IKPU=l),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"IKPU code"},null,512),[[C,d.value.IKPU]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Valyuta",-1)),_(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>d.value.currency=l),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500"},t[24]||(t[24]=[e("option",{value:"UZS"},"UZS",-1),e("option",{value:"USD"},"USD",-1)]),512),[[N,d.value.currency]])])])]),e("div",jt,[e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Rasm",-1)),k(me,{onImageSelected:O})]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Og'irligi (gramda)",-1)),_(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>d.value.weight=l),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:""},null,512),[[C,d.value.weight]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"EAN13",-1)),_(e("input",{"onUpdate:modelValue":t[9]||(t[9]=l=>d.value.ean13=l),type:"text",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2 focus:ring-2 focus:ring-indigo-500",placeholder:"EAN13 code"},null,512),[[C,d.value.ean13]])])])]),e("div",Bt,[k(F,{type:"button",variant:"secondary",loading:y.value,disabled:y.value,onClick:t[10]||(t[10]=l=>j(!1))},{default:A(()=>[y.value?(a(),i($,{key:1},[q("Saqlanmoqda...")],64)):(a(),i($,{key:0},[q("Saqlash va yopish")],64))]),_:1},8,["loading","disabled"]),k(F,{type:"button",loading:y.value,disabled:y.value,onClick:t[11]||(t[11]=l=>j(!0))},{default:A(()=>[y.value?(a(),i($,{key:1},[q("Saqlanmoqda...")],64)):(a(),i($,{key:0},[q("Saqlash va ko'rish")],64))]),_:1},8,["loading","disabled"])])],32))]))}},Lt={class:"space-y-6"},Ot={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},Tt={class:"flex justify-between items-center"},er={__name:"ProductsView",setup(v){const x=p(!1),n=p(null),f=()=>{x.value=!1,n.value&&n.value.loadProducts()};return(u,m)=>(a(),i("div",null,[e("div",Lt,[e("div",Ot,[e("div",Tt,[m[4]||(m[4]=e("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-white"},"Products",-1)),k(F,{onClick:m[0]||(m[0]=s=>x.value=!0)},{default:A(()=>m[3]||(m[3]=[q("Add Product")])),_:1})])]),k(tt,{ref_key:"productListRef",ref:n},null,512)]),(a(),I(ge,{to:"body"},[x.value?(a(),I(ot,{key:0,"is-open":x.value,width:"600px",onClose:m[2]||(m[2]=s=>x.value=!1)},{title:A(()=>m[5]||(m[5]=[q("Add New Product")])),default:A(()=>{var s,y;return[k(Rt,{categories:((s=n.value)==null?void 0:s.categories)||[],stores:((y=n.value)==null?void 0:y.stores)||[],onClose:m[1]||(m[1]=h=>x.value=!1),onProductAdded:f},null,8,["categories","stores"])]}),_:1},8,["is-open"])):K("",!0)]))]))}};export{er as default};
