import{g as _,h as W,q as R,s as U,o as h,c as b,a as p,f as w,i as G,L as Q,F as H,b as X,t as E,z as q,k as J,B as N}from"./index-D3wbM7oO.js";var K=typeof global=="object"&&global&&global.Object===Object&&global,Y=typeof self=="object"&&self&&self.Object===Object&&self,F=K||Y||Function("return this")(),$=F.Symbol,A=Object.prototype,Z=A.hasOwnProperty,ee=A.toString,O=$?$.toStringTag:void 0;function te(e){var n=Z.call(e,O),c=e[O];try{e[O]=void 0;var o=!0}catch{}var d=ee.call(e);return o&&(n?e[O]=c:delete e[O]),d}var ae=Object.prototype,ne=ae.toString;function re(e){return ne.call(e)}var se="[object Null]",oe="[object Undefined]",z=$?$.toStringTag:void 0;function ie(e){return e==null?e===void 0?oe:se:z&&z in Object(e)?te(e):re(e)}function le(e){return e!=null&&typeof e=="object"}var ue="[object Symbol]";function ce(e){return typeof e=="symbol"||le(e)&&ie(e)==ue}var de=/\s/;function fe(e){for(var n=e.length;n--&&de.test(e.charAt(n)););return n}var ge=/^\s+/;function me(e){return e&&e.slice(0,fe(e)+1).replace(ge,"")}function P(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var C=NaN,ve=/^[-+]0x[0-9a-f]+$/i,he=/^0b[01]+$/i,be=/^0o[0-7]+$/i,pe=parseInt;function D(e){if(typeof e=="number")return e;if(ce(e))return C;if(P(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=P(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=me(e);var c=he.test(e);return c||be.test(e)?pe(e.slice(2),c?2:8):ve.test(e)?C:+e}var M=function(){return F.Date.now()},ye="Expected a function",_e=Math.max,ke=Math.min;function xe(e,n,c){var o,d,g,i,a,l,f=0,y=!1,m=!1,k=!0;if(typeof e!="function")throw new TypeError(ye);n=D(n)||0,P(c)&&(y=!!c.leading,m="maxWait"in c,g=m?_e(D(c.maxWait)||0,n):g,k="trailing"in c?!!c.trailing:k);function T(t){var u=o,S=d;return o=d=void 0,f=t,i=e.apply(S,u),i}function L(t){return f=t,a=setTimeout(x,n),y?T(t):i}function B(t){var u=t-l,S=t-f,v=n-u;return m?ke(v,g-S):v}function I(t){var u=t-l,S=t-f;return l===void 0||u>=n||u<0||m&&S>=g}function x(){var t=M();if(I(t))return j(t);a=setTimeout(x,B(t))}function j(t){return a=void 0,k&&o?T(t):(o=d=void 0,i)}function V(){a!==void 0&&clearTimeout(a),f=0,o=l=d=a=void 0}function r(){return a===void 0?i:j(M())}function s(){var t=M(),u=I(t);if(o=arguments,d=this,l=t,u){if(a===void 0)return L(l);if(m)return clearTimeout(a),a=setTimeout(x,n),T(l)}return a===void 0&&(a=setTimeout(x,n)),i}return s.cancel=V,s.flush=r,s}const Se={class:"search-select-container relative"},Te=["value","placeholder","disabled"],je={key:0,class:"absolute right-3 top-2.5"},we={class:"absolute z-50 w-full mt-1 bg-white dark:bg-white-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700"},Oe={class:"py-1 max-h-60 overflow-auto"},Ie=["onClick"],Ee={class:"flex justify-between items-center"},$e={class:"text-gray-900 dark:text-black"},Le={class:"flex gap-2"},Be={key:0,class:"text-sm text-red-600 dark:text-red-600"},Me={key:1,class:"text-sm text-blue-600 dark:text-blue-600"},Pe={key:0,class:"border-t border-gray-200"},Ve=["disabled"],Ne={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"},Ce={__name:"SearchSelect",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Qidirish..."},searchEndpoint:{type:String,required:!0},additionalParams:{type:Object,default:()=>({})},displayValue:{type:String,default:""},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(e,{expose:n,emit:c}){const o=e,d=c,g=_(!1),i=_(!1),a=_([]),l=_(!1),f=_(o.displayValue||""),y=_(1),m=_(!1),k=async(r="",s=1)=>{try{s===1?g.value=!0:i.value=!0;const t={Authorization:`Bearer ${localStorage.getItem("token")}`},u={...o.additionalParams};r&&(u.search=r);const v=(await N.get(`${o.searchEndpoint}`,{headers:t,params:u})).data;s===1?a.value=r?v:v.slice(0,5):a.value=[...a.value,...v],m.value=r?v.length>a.value.length:v.length>5,y.value=s}catch(t){console.error("Error fetching items:",t)}finally{g.value=!1,i.value=!1}},T=xe(async r=>{y.value=1,await k(r)},300),L=r=>{const s=r.target.value;f.value=s,l.value=!0,T(s)},B=async()=>{l.value=!0,a.value.length===0&&await k()},I=r=>{f.value=r.name,l.value=!1,d("update:modelValue",r.id),d("select",r)},x=async r=>{if(i.value)return;r.preventDefault(),r.stopPropagation();const s=await N.get(`${o.searchEndpoint}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},params:o.additionalParams}).then(u=>u.data),t=a.value.length;a.value=s.slice(0,t+5),m.value=s.length>a.value.length,y.value+=1},j=r=>{r.target.closest(".search-select-container")||(l.value=!1)};return n({reset:()=>{f.value="",a.value=[],l.value=!1,g.value=!1,i.value=!1,y.value=1,m.value=!1,d("update:modelValue","")}}),W(()=>o.displayValue,r=>{f.value=r}),R(()=>{document.addEventListener("click",j)}),U(()=>{document.removeEventListener("click",j)}),(r,s)=>(h(),b("div",Se,[p("input",{type:"text",value:f.value,onInput:L,onFocus:B,placeholder:e.placeholder,disabled:e.disabled,class:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-100"},null,40,Te),g.value?(h(),b("div",je,s[0]||(s[0]=[p("div",{class:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-900"},null,-1)]))):w("",!0),G(p("div",we,[p("ul",Oe,[(h(!0),b(H,null,X(a.value,t=>(h(),b("li",{key:t.id,onClick:u=>I(t),class:"px-3 py-2 hover:bg-gray-100 cursor-pointer"},[p("div",Ee,[p("span",$e,E(t.name),1),p("div",Le,[t.sku?(h(),b("span",Be,E(t.sku),1)):w("",!0),t.uzum_sku_title||t.uzum_sku?(h(),b("span",Me,E(t.uzum_sku_title||t.uzum_sku),1)):w("",!0)])])],8,Ie))),128))]),m.value?(h(),b("div",Pe,[p("button",{onClick:q(x,["stop"]),class:"w-full px-3 py-2 text-center text-blue-600 hover:bg-gray-50 cursor-pointer flex items-center justify-center",disabled:i.value},[i.value?(h(),b("div",Ne)):w("",!0),J(" "+E(i.value?"Loading...":"Show More"),1)],8,Ve)])):w("",!0)],512),[[Q,l.value&&a.value.length>0]])]))}};export{Ce as _};
