import{g as m,B as L,_ as de,A as he,q as te,s as re,p as _e,h as ae,o as y,c as v,a as e,d as p,F as U,b as M,n as A,z as Q,t as k,f as Y,u as B,x as be,i as F,j as Z,J as se,k as O,K as oe,m as ue,H as we,L as Se,M as Ce,v as le,N as Fe,w as ie}from"./index-D3wbM7oO.js";import{_ as ne}from"./Button-1RoVZDeX.js";import{_ as ze}from"./Pagination-CtU1Q35g.js";import{_ as C}from"./CopyableText-dJNKi8uI.js";import{A as ce}from"./api-JDA1JVME.js";import{g as N}from"./auth-Buz3Qiex.js";function De(){const r=m([]),i=m({current_page:1,per_page:20,total:0,filtered_total:0,this_page:0,last_page:1}),x=m(!1),c=m(null),o=m({}),n=m(null),s=m(null),g=async(_=1,P=20,S=null)=>{var q,V;x.value=!0,c.value=null,o.value=S||{};try{const w=await N(),D=new URLSearchParams({page:_.toString(),per_page:P.toString()});n.value&&s.value&&(D.append("sortBy",n.value),D.append("sortDirection",s.value)),S&&Object.entries(S).forEach(([T,l])=>{l!=null&&l!==""&&l!==!1&&D.append(T,l.toString())});const b=await L.get(`${ce}/shipments/send/get`,{headers:w,params:D});if(console.log("API Response:",b.data),b.data.success)r.value=b.data.data,console.log("Shipments:",r.value),i.value={...b.data.meta,filtered_total:b.data.meta.total,per_page:P},console.log("Meta:",i.value);else throw new Error(b.data.message||"Failed to fetch shipments")}catch(w){console.error("Error fetching shipments:",w),c.value=((V=(q=w.response)==null?void 0:q.data)==null?void 0:V.message)||w.message||"Failed to fetch shipments"}finally{x.value=!1}};return{shipments:r,meta:i,loading:x,error:c,fetchShipments:g,sortBy:n,sortDirection:s,setSort:(_,P)=>{n.value=_,s.value=P,g(i.value.current_page,i.value.per_page,o.value)},handlePageChange:_=>{g(_,i.value.per_page,o.value)},handlePerPageChange:_=>{g(1,_,o.value)},applyFilters:_=>{g(1,i.value.per_page,_)},resetFilters:()=>{o.value={},n.value=null,s.value=null,g(1,i.value.per_page)}}}const $e={class:"relative"},Ue={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Me={class:"bg-gray-50 dark:bg-gray-700"},Be={class:"px-4 py-2"},Ee=["checked"],Pe={class:"flex items-center space-x-1"},Ae={class:"flex items-center space-x-1"},qe={class:"flex items-center space-x-1"},Ve={class:"flex items-center space-x-1"},Ie={class:"flex items-center space-x-1"},je={class:"flex items-center space-x-1"},Le={class:"flex items-center space-x-1"},Oe={class:"flex items-center space-x-1"},Ne={class:"flex items-center space-x-1"},Re={class:"flex items-center justify-end space-x-1"},Te={class:"flex items-center justify-end space-x-1"},He={class:"flex items-center justify-end space-x-1"},Ke={class:"flex items-center space-x-1"},Qe={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Ye=["onClick"],Ze=["checked","disabled","onChange"],We={class:"px-4 py-2 text-gray-900 dark:text-gray-200"},Xe={class:"px-4 py-2 text-gray-900 dark:text-gray-200"},Je={class:"whitespace-nowrap"},Ge={class:"text-sm text-gray-500 dark:text-gray-400"},et={class:"px-4 py-2 text-gray-900 dark:text-gray-200"},tt={class:"px-4 py-2 text-gray-900 dark:text-gray-200"},rt={class:"px-4 py-2 text-gray-900 dark:text-gray-200 whitespace-nowrap"},at={class:"px-4 py-2 text-gray-900 dark:text-gray-200 min-w-[24rem] max-w-[24rem]"},st={class:"break-words"},ot={class:"px-4 py-2 text-gray-900 dark:text-gray-200 whitespace-nowrap"},lt={class:"px-4 py-2 text-gray-900 dark:text-gray-200 whitespace-nowrap"},it={class:"px-4 py-2 text-gray-900 dark:text-gray-200 whitespace-nowrap"},nt={key:0,class:"text-sm text-gray-500 dark:text-gray-400 block"},dt={class:"px-4 py-2 text-right text-gray-900 dark:text-gray-200 whitespace-nowrap"},ut={class:"px-4 py-2 text-right text-gray-900 dark:text-gray-200 whitespace-nowrap"},ct={class:"px-4 py-2 text-right text-gray-900 dark:text-gray-200"},pt={class:"px-4 py-2"},gt={class:"px-4 py-2 text-gray-900 dark:text-gray-200"},yt={class:"px-4 py-2 text-gray-900 dark:text-gray-200"},vt={class:"mt-4"},xt={key:0,class:"p-4"},ft={class:"flex flex-col space-y-4"},mt={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},kt={class:"flex flex-col space-y-2"},ht=["disabled"],_t={key:0,class:"flex items-center justify-center"},bt={key:1},wt={key:1,class:"p-4"},St={class:"flex items-center justify-between"},Ct={class:"flex items-center space-x-4"},Ft={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},zt={class:"relative"},Dt={class:"flex items-center space-x-2"},$t=["disabled"],Ut={key:0,class:"flex items-center"},Mt={key:1},Bt={__name:"ShipmentTable",props:{filters:{type:Object,default:()=>({})}},emits:["sortChange"],setup(r,{emit:i}){const x=he(),c=m([]),o=m(""),n=m(!1),s=m(!1),g=()=>{s.value=window.innerWidth<768},E=r,R=i,{shipments:z,meta:W,loading:_,error:P,fetchShipments:S,handlePageChange:q,handlePerPageChange:V,applyFilters:w,resetFilters:D}=De();te(()=>{S(),g(),window.addEventListener("resize",g)}),re(()=>{window.removeEventListener("resize",g)});const b=_e(()=>z.value.length>0&&c.value.length===z.value.length),T=d=>({sold:"Sotilgan",to_sold:"Sotilgan",returned:"Qaytarilgan",to_returned:"Qaytarilgan",brak:"Brak",to_brak:"Brak",is_null:"Yangi"})[d]||"Yangi",l=m(null),f=m(null),pe=["zoodmall","Ofis","fba","fbs"],I=d=>pe.includes(d.order_method),h=d=>{l.value===d?f.value=f.value==="asc"?"desc":"asc":(l.value=d,f.value="asc");const t={...E.filters,sortBy:l.value,sortDirection:f.value};R("sortChange",{sortBy:l.value,sortDirection:f.value}),w(t)};ae(()=>E.filters,d=>{Object.values(d).every(u=>!u)&&!E.preserveSort&&(l.value=null,f.value=null,R("sortChange",{sortBy:null,sortDirection:null}))},{deep:!0});const ge=()=>{b.value?c.value=[]:c.value=z.value.map(d=>d.id)},ye=d=>{const t=z.value.find(u=>u.id===d);if(I(t)){const u=c.value.indexOf(d);u===-1?c.value.push(d):c.value.splice(u,1)}},j=()=>{c.value=[],o.value=""},X=async()=>{var d;if(!(!o.value||n.value||c.value.length===0))try{if(n.value=!0,o.value==="delete"){if(!confirm(`Ishonchingiz komilmi? Ochirilgan buyurtmalar qaytarilmaydi ${c.value.length} ta?`))return;console.log("Sending delete request with ids:",c.value);const t=await L.delete(`${oe}/shipments/send/delete`,{data:{ids:c.value.map(u=>parseInt(u,10))},headers:await N()});console.log("Delete response:",t.data),t.data.status?(x.success(t.data.message),j(),S()):x.error(t.data.message||"Xatolik yuz berdi")}else{const t=o.value.replace("status_","");console.log("Sending status update request:",{processed:t,shipments:c.value.map($=>({id:parseInt($,10),processed:t}))});const u=await L.put(`${oe}/shipments/send/status`,{shipments:c.value.map($=>({id:parseInt($,10),processed:t}))},{headers:await N()});console.log("Update response:",u.data),u.data.status?(x.success(u.data.message),u.data.errors&&u.data.errors.length>0&&(console.warn("Some updates had errors:",u.data.errors),x.warning(`${u.data.success_count} updated, ${u.data.errors.length} failed`)),j(),S()):(x.error(u.data.message||"Holatini o'zgartirishda xatolik yuz berdi"),u.data.errors&&console.error("Update errors:",u.data.errors))}}catch(t){console.error("Bulk action error:",t),t.response?(console.error("Error response:",t.response.data),x.error(((d=t.response.data)==null?void 0:d.message)||"Server error occurred")):t.request?(console.error("Error request:",t.request),x.error("Network error occurred")):(console.error("Error:",t.message),x.error("An unexpected error occurred"))}finally{n.value=!1}},ve=ue(),xe=d=>{I(d)&&ve.push(`/shipment/create/${d.id}`)},H=m(null),J=m(0),G=m(0),K=()=>{if(H.value){const d=H.value.getBoundingClientRect();J.value=d.width,G.value=d.left}};te(()=>{K(),window.addEventListener("resize",K)}),re(()=>{window.removeEventListener("resize",K)}),ae(()=>E.filters,d=>{d===null?D():w(d)},{deep:!0});const ee=d=>new Intl.NumberFormat("uz-UZ",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(d),fe=d=>{if(!d)return"";const t=new Date(d);return new Intl.DateTimeFormat("uz-UZ",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t)},me=d=>{if(!d)return"";const t=new Date(d);return new Intl.DateTimeFormat("uz-UZ",{hour:"2-digit",minute:"2-digit"}).format(t)};return(d,t)=>{var $;const u=we("SortIcon");return y(),v("div",$e,[e("div",{class:"overflow-x-auto",ref_key:"tableContainer",ref:H},[e("table",Ue,[e("thead",Me,[e("tr",null,[e("th",Be,[e("input",{type:"checkbox",checked:b.value,onChange:ge,class:"h-4 w-4 text-blue-600 rounded border-gray-300 dark:border-gray-600 focus:ring-blue-500"},null,40,Ee)]),e("th",{onClick:t[0]||(t[0]=a=>h("id")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Pe,[t[17]||(t[17]=e("span",null,"ID",-1)),p(u,{active:l.value==="id",direction:l.value==="id"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[1]||(t[1]=a=>h("created_at")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Ae,[t[18]||(t[18]=e("span",null,"Yaratilgan sanasi",-1)),p(u,{active:l.value==="created_at",direction:l.value==="created_at"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[2]||(t[2]=a=>h("order_id")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",qe,[t[19]||(t[19]=e("span",null,"Buyurtma raqami",-1)),p(u,{active:l.value==="order_id",direction:l.value==="order_id"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[3]||(t[3]=a=>h("invoice_id")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Ve,[t[20]||(t[20]=e("span",null,"Nakladnoy",-1)),p(u,{active:l.value==="invoice_id",direction:l.value==="invoice_id"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[4]||(t[4]=a=>h("store")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Ie,[t[21]||(t[21]=e("span",null,"Do'kon",-1)),p(u,{active:l.value==="store",direction:l.value==="store"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[5]||(t[5]=a=>h("product")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",je,[t[22]||(t[22]=e("span",null,"Mahsulot",-1)),p(u,{active:l.value==="product",direction:l.value==="product"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[6]||(t[6]=a=>h("article")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Le,[t[23]||(t[23]=e("span",null,"Artikul",-1)),p(u,{active:l.value==="article",direction:l.value==="article"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[7]||(t[7]=a=>h("sku")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Oe,[t[24]||(t[24]=e("span",null,"SKU",-1)),p(u,{active:l.value==="sku",direction:l.value==="sku"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[8]||(t[8]=a=>h("uzum_sku")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Ne,[t[25]||(t[25]=e("span",null,"Uzum SKU",-1)),p(u,{active:l.value==="uzum_sku",direction:l.value==="uzum_sku"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[9]||(t[9]=a=>h("sell_price")),class:"px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Re,[t[26]||(t[26]=e("span",null,"Sotuv narxi",-1)),p(u,{active:l.value==="sell_price",direction:l.value==="sell_price"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[10]||(t[10]=a=>h("buy_price")),class:"px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Te,[t[27]||(t[27]=e("span",null,"Xarid narxi",-1)),p(u,{active:l.value==="buy_price",direction:l.value==="buy_price"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[11]||(t[11]=a=>h("quantity")),class:"px-4 py-2 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",He,[t[28]||(t[28]=e("span",null,"Miqdor",-1)),p(u,{active:l.value==="quantity",direction:l.value==="quantity"?f.value:null},null,8,["active","direction"])])]),e("th",{onClick:t[12]||(t[12]=a=>h("processed")),class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600"},[e("div",Ke,[t[29]||(t[29]=e("span",null,"Holati",-1)),p(u,{active:l.value==="processed",direction:l.value==="processed"?f.value:null},null,8,["active","direction"])])]),t[30]||(t[30]=e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Source",-1)),t[31]||(t[31]=e("th",{class:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Izoh",-1))])]),e("tbody",Qe,[(y(!0),v(U,null,M(B(z),a=>(y(),v("tr",{key:a.id,class:A(["transition-colors duration-150",I(a)?"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800/50":"opacity-75"]),onClick:ke=>xe(a)},[e("td",{class:"px-4 py-2",onClick:t[14]||(t[14]=Q(()=>{},["stop"]))},[e("input",{type:"checkbox",checked:c.value.includes(a.id),disabled:!I(a),onChange:ke=>ye(a.id),onClick:t[13]||(t[13]=Q(()=>{},["stop"])),class:"h-4 w-4 text-blue-600 rounded border-gray-300 dark:border-gray-600 focus:ring-blue-500 disabled:opacity-50"},null,40,Ze)]),e("td",We,[p(C,{text:a.id.toString()},null,8,["text"])]),e("td",Xe,[e("div",Je,k(fe(a.created_at)),1),e("div",Ge,k(me(a.created_at)),1)]),e("td",et,[p(C,{text:a.order_id||a.order_no},null,8,["text"])]),e("td",tt,[p(C,{text:a.invoice_id?a.invoice_id.toString():""},null,8,["text"])]),e("td",rt,[p(C,{text:a.store},null,8,["text"])]),e("td",at,[e("div",st,k(a.product),1)]),e("td",ot,[p(C,{text:a.article},null,8,["text"])]),e("td",lt,[p(C,{text:a.sku},null,8,["text"])]),e("td",it,[p(C,{text:a.uzum_sku},null,8,["text"]),a.uzum_sku_title?(y(),v("span",nt,k(a.uzum_sku_title),1)):Y("",!0)]),e("td",dt,k(ee(a.sell_price))+" UZS",1),e("td",ut,k(ee(a.buy_price))+" UZS",1),e("td",ct,k(a.quantity),1),e("td",pt,[e("span",{class:A({"px-2 py-1 rounded text-sm":!0,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":a.processed==="sold"||a.processed==="to_sold","bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":a.processed==="returned"||a.processed==="to_returned","bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200":a.processed==="brak"||a.processed==="to_brak","bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200":!a.processed})},k(T(a.processed)),3)]),e("td",gt,k(a.order_method),1),e("td",yt,k(a.desc),1)],10,Ye))),128))])])],512),e("div",vt,[p(ze,{meta:B(W),onPageChange:B(q),onPerPageChange:B(V)},null,8,["meta","onPageChange","onPerPageChange"])]),c.value.length>0?(y(),v("div",{key:0,class:A(["fixed bottom-0 bg-white dark:bg-gray-800 shadow-lg border-t border-gray-200 dark:border-gray-700 transform transition-transform duration-200 z-50",{"translate-y-0":c.value.length>0,"translate-y-full":c.value.length===0}]),style:be(s.value?{left:"0",width:"100%"}:{width:J.value+"px",left:G.value+"px"})},[s.value?(y(),v("div",xt,[e("div",ft,[e("div",mt,k(c.value.length)+" items selected ",1),F(e("select",{"onUpdate:modelValue":t[15]||(t[15]=a=>o.value=a),class:"w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 px-3 text-sm"},t[32]||(t[32]=[se('<option value="" data-v-16903016>Select Action</option><option value="status_to_sold" data-v-16903016>Mark as Sotilgan</option><option value="status_to_returned" data-v-16903016>Mark as Qaytarilgan</option><option value="status_to_brak" data-v-16903016>Mark as Brak</option><option value="delete" data-v-16903016>Delete Selected</option>',5)]),512),[[Z,o.value]]),e("div",kt,[e("button",{onClick:X,disabled:!o.value||n.value,class:"w-full px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"},[n.value?(y(),v("span",_t,t[33]||(t[33]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),O(" Processing... ")]))):(y(),v("span",bt,"Apply"))],8,ht),e("button",{onClick:j,class:"w-full px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md"}," Cancel ")])])])):(y(),v("div",wt,[e("div",St,[e("div",Ct,[e("span",Ft,k(c.value.length)+" items selected ",1),e("div",zt,[F(e("select",{"onUpdate:modelValue":t[16]||(t[16]=a=>o.value=a),class:"appearance-none bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md py-2 pl-3 pr-8 text-sm leading-4 font-medium text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},t[34]||(t[34]=[se('<option value="" data-v-16903016>Select Action</option><optgroup label="Status Changes" data-v-16903016><option value="status_to_sold" data-v-16903016>Mark as Sotilgan</option><option value="status_to_returned" data-v-16903016>Mark as Qaytarilgan</option><option value="status_to_brak" data-v-16903016>Mark as Brak</option></optgroup><optgroup label="Danger Zone" data-v-16903016><option value="delete" data-v-16903016>Delete Selected</option></optgroup>',3)]),512),[[Z,o.value]])])]),e("div",Dt,[e("button",{onClick:j,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors duration-150"}," Cancel "),e("button",{onClick:X,disabled:!o.value||n.value,class:A({"px-4 py-2 text-sm font-medium rounded-md transition-colors duration-150":!0,"bg-blue-600 text-white hover:bg-blue-700":o.value&&!o.value.startsWith("delete"),"bg-red-600 text-white hover:bg-red-700":($=o.value)==null?void 0:$.startsWith("delete"),"opacity-50 cursor-not-allowed":!o.value||n.value})},[n.value?(y(),v("span",Ut,t[35]||(t[35]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),O(" Processing... ")]))):(y(),v("span",Mt,"Apply"))],10,$t)])])]))],6)):Y("",!0)])}}},Et=de(Bt,[["__scopeId","data-v-16903016"]]),Pt={name:"ShipmentsFilter",data(){return{isExpanded:!0,loading:!1,filters:{invoice_id:"",order:"",store_id:"",user_id:"",duplicates:!1,no_store:!1,no_quantity:!1,created_from:"",created_to:"",updated_from:"",updated_to:"",processed:"",desc:"",product:"",article:"",sku:"",uzum_sku:""},sortState:{sortBy:null,sortDirection:null},filterData:{stores:[],order_methods:[],users:[],processed:{},data_issues:{}},textFields:[{key:"order",label:"Buyurtma raqam",placeholder:"Buyurtma raqamini kiriting"},{key:"invoice_id",label:"Nakladnoy raqam",placeholder:"Nakladnoy raqamini kiriting"},{key:"product",label:"Mahsulot nomi",placeholder:"Mahsulot nomini kiriting"},{key:"article",label:"Artikul",placeholder:"Artikulni kiriting"},{key:"sku",label:"SKU",placeholder:"SKU ni kiriting"},{key:"uzum_sku",label:"Uzum SKU",placeholder:"Uzum SKU ni kiriting"}],dateFields:[{key:"created_from",label:"Created from"},{key:"created_to",label:"Created to"},{key:"updated_from",label:"Updated from"},{key:"updated_to",label:"Updated to"}]}},computed:{selectFields(){return[{key:"store_id",label:"Do'kon",placeholder:"Do'konni tanlang",options:this.filterData.stores.map(r=>({value:r.id,label:r.name}))},{key:"order_method",label:"Order method",placeholder:"Order method tanlang",options:this.filterData.order_methods.map(r=>({value:r,label:r}))},{key:"processed",label:"Holati",placeholder:"Holatni tanlang",options:Object.entries(this.filterData.processed).map(([r,i])=>({value:r,label:this.formatProcessedLabel(r)}))},{key:"user_id",label:"User",placeholder:"Foydalanuvchini tanlang",options:this.filterData.users.map(r=>({value:r.id,label:r.name}))}]},checkboxFields(){return Object.values(this.filterData.data_issues).map(r=>({key:r.value,label:r.label,description:r.description}))}},watch:{filters:{deep:!0,handler(r,i){}}},methods:{toggleExpanded(){this.isExpanded=!this.isExpanded},formatProcessedLabel(r){return{sold:"Sotilgan",to_sold:"Sotilgan",returned:"Qaytarilgan",to_returned:"Qaytarilgan",brak:"Brak",to_brak:"Brak",is_null:"Yangi"}[r]||r},resetFilters(){this.filters={invoice_id:"",order:"",store_id:"",user_id:"",duplicates:!1,no_store:!1,no_quantity:!1,created_from:"",created_to:"",updated_from:"",updated_to:"",processed:"",desc:"",product:"",article:"",sku:"",uzum_sku:""},this.$emit("filter",{})},applyFilters(){const r={...this.sortState};this.filters.order&&(r.order=this.filters.order),this.filters.invoice_id&&(r.invoice_id=this.filters.invoice_id),this.filters.product&&(r.product=this.filters.product),this.filters.article&&(r.article=this.filters.article),this.filters.sku&&(r.sku=this.filters.sku),this.filters.uzum_sku&&(r.uzum_sku=this.filters.uzum_sku),this.filters.desc&&(r.desc=this.filters.desc),this.filters.store_id&&(r.store_id=this.filters.store_id),this.filters.order_method&&(r.order_method=this.filters.order_method),this.filters.processed&&(r.processed=this.filters.processed),this.filters.user_id&&(r.user_id=this.filters.user_id),this.filters.duplicates?r.data_issues="duplicates":this.filters.no_store?r.data_issues="no_store":this.filters.no_quantity&&(r.data_issues="no_quantity"),this.filters.created_from&&(r.created_from=this.filters.created_from),this.filters.created_to&&(r.created_to=this.filters.created_to),this.filters.updated_from&&(r.updated_from=this.filters.updated_from),this.filters.updated_to&&(r.updated_to=this.filters.updated_to),this.$emit("filter",r)},updateSortState(r){this.sortState=r;const i={...this.sortState,...Object.entries(this.filters).filter(([x,c])=>c!==""&&c!==null&&c!==!1).reduce((x,[c,o])=>({...x,[c]:o}),{})};this.$emit("filter",i)},async fetchFilterData(){try{const r=await N(),i=await L.get(`${ce}/shipments/send/filters`,{headers:r});i.data.success&&(this.filterData=i.data.data)}catch(r){console.error("Error fetching filter data:",r)}}},mounted(){this.fetchFilterData()}},At={class:"shipments-filter"},qt={class:"flex justify-between items-center mb-4 px-6 pt-4"},Vt={class:"px-6 pb-4"},It={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4"},jt=["for"],Lt=["id","onUpdate:modelValue","placeholder"],Ot=["for"],Nt=["id","onUpdate:modelValue"],Rt={value:""},Tt=["value"],Ht=["for"],Kt=["id","onUpdate:modelValue"],Qt={class:"mt-6 flex flex-wrap gap-6"},Yt=["id","onUpdate:modelValue"],Zt=["for"],Wt={class:"flex justify-end space-x-4 mt-4"};function Xt(r,i,x,c,o,n){return y(),v("div",At,[e("div",qt,[i[5]||(i[5]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"Filterlar",-1)),e("button",{onClick:i[0]||(i[0]=(...s)=>n.toggleExpanded&&n.toggleExpanded(...s)),class:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"},[(y(),v("svg",{class:A(["w-6 h-6 transform transition-transform duration-200",{"rotate-180":!o.isExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},i[4]||(i[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])]),F(e("div",Vt,[e("form",{onSubmit:i[3]||(i[3]=Q((...s)=>n.applyFilters&&n.applyFilters(...s),["prevent"])),class:"space-y-4"},[e("div",It,[(y(!0),v(U,null,M(o.textFields,s=>(y(),v("div",{key:s.key,class:"form-group"},[e("label",{for:s.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},k(s.label),9,jt),F(e("input",{id:s.key,type:"text","onUpdate:modelValue":g=>o.filters[s.key]=g,placeholder:s.placeholder,onKeyup:i[1]||(i[1]=Ce((...g)=>n.applyFilters&&n.applyFilters(...g),["enter"])),class:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent transition duration-150 ease-in-out"},null,40,Lt),[[le,o.filters[s.key]]])]))),128)),(y(!0),v(U,null,M(n.selectFields,s=>(y(),v("div",{key:s.key,class:"form-group"},[e("label",{for:s.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},k(s.label),9,Ot),F(e("select",{id:s.key,"onUpdate:modelValue":g=>o.filters[s.key]=g,class:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent transition duration-150 ease-in-out"},[e("option",Rt,k(s.placeholder),1),s.options?(y(!0),v(U,{key:0},M(s.options,g=>(y(),v("option",{key:g.value,value:g.value},k(g.label),9,Tt))),128)):Y("",!0)],8,Nt),[[Z,o.filters[s.key]]])]))),128)),(y(!0),v(U,null,M(o.dateFields,s=>(y(),v("div",{key:s.key,class:"form-group"},[e("label",{for:s.key,class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},k(s.label),9,Ht),F(e("input",{id:s.key,type:"date","onUpdate:modelValue":g=>o.filters[s.key]=g,class:"w-full px-3 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent transition duration-150 ease-in-out"},null,8,Kt),[[le,o.filters[s.key]]])]))),128))]),e("div",Qt,[(y(!0),v(U,null,M(n.checkboxFields,s=>(y(),v("div",{key:s.key,class:"flex items-center"},[F(e("input",{id:s.key,type:"checkbox","onUpdate:modelValue":g=>o.filters[s.key]=g,class:"h-4 w-4 text-blue-600 dark:text-blue-400 focus:ring-blue-500 dark:focus:ring-blue-400 border-gray-300 dark:border-gray-600 rounded transition duration-150 ease-in-out"},null,8,Yt),[[Fe,o.filters[s.key]]]),e("label",{for:s.key,class:"ml-2 block text-sm text-gray-700 dark:text-gray-300"},k(s.label),9,Zt)]))),128))]),e("div",Wt,[e("button",{type:"button",onClick:i[2]||(i[2]=(...s)=>n.resetFilters&&n.resetFilters(...s)),class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200"}," Reset "),i[6]||(i[6]=e("button",{type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200"}," Apply Filters ",-1))])],32)],512),[[Se,o.isExpanded]])])}const Jt=de(Pt,[["render",Xt],["__scopeId","data-v-ed42cd17"]]),Gt={class:"space-y-6"},er={class:"bg-white dark:bg-gray-800 shadow rounded-lg p-6"},tr={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},rr={class:"flex gap-4"},ar={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},sr={class:"bg-white dark:bg-gray-800 shadow rounded-lg"},cr={__name:"ShipmentView",setup(r){const i=ue();m(!1),m(null);const x=m({}),c=o=>{x.value=o};return(o,n)=>(y(),v("div",Gt,[e("div",er,[e("div",tr,[n[4]||(n[4]=e("h1",{class:"text-2xl font-semibold text-gray-900 dark:text-white"},"Yuborishlar",-1)),e("div",rr,[p(ne,{variant:"primary",onClick:n[0]||(n[0]=s=>B(i).push("/shipment/uzum"))},{default:ie(()=>n[2]||(n[2]=[O(" Uzum ")])),_:1}),p(ne,{variant:"primary",onClick:n[1]||(n[1]=s=>B(i).push({name:"create-shipment"}))},{default:ie(()=>n[3]||(n[3]=[O(" Yaratish ")])),_:1})])])]),e("div",ar,[p(Jt,{onFilter:c})]),e("div",sr,[p(Et,{filters:x.value},null,8,["filters"])])]))}};export{cr as default};
